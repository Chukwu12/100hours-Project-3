<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>
    <%= user.userName %>'s Profile
  </title>
  <!-- Font-awesome -->
  <script src="https://kit.fontawesome.com/bb1892d46f.js" crossorigin="anonymous"></script>
  <!-- Glide.js CSS -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@glidejs/glide/dist/css/glide.core.min.css">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@glidejs/glide/dist/css/glide.theme.min.css">
  <!-- Bootstrap -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet"
    integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
  <!-- Custom CSS -->
  <link rel="stylesheet" href="/css/style.css">
  <link rel="stylesheet" href="/css/styles.css">
</head>

<body>
  <header id="main-nav">
    <div class="container-fluid">
      <nav class="navbar navbar-expand-md navbar-light bg-light">
        <a class="navbar-brand" href="/" aria-label="Homepage">
          <img src="/image/onice-logo.png" alt="Onice Logo" height="30">
        </a>
        <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav"
          aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
          <span class="navbar-toggler-icon"></span>
        </button>

        <div class="collapse navbar-collapse " id="navbarNav">
          <ul class="navbar-nav">
            <li class="nav-item">
              <a class="nav-link" href="/">Home</a>
            </li>
            <li class="nav-item">
              <a class="nav-link active" aria-current="page" href="/recipe">Recipes</a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="/profile">Profile</a>
            </li>
          </ul>
        </div>
      </nav>
    </div>
  </header>





  <!-- Background Wrapper -->
  <div class="background-wrapper">

    <!-- Profile Card -->
    <section id="user-card">
      <div class="shadow overflow">
        <div id="header"></div>
        <div id="profile">
          <div class="profile-image">
            <!-- Display the user's profile image or the default image -->
            <img src="<%= user.profileImage || '/image/user-profilepic.png' %>" alt="<%= user.userName %>'s profile"
              id="profile-image-display">
            <!-- File input for uploading the image -->
            <input type="file" id="profile-image-upload" accept="image/*" style="display:none;" autocomplete="on"
              onchange="previewImage(event)" />
          </div>

          <div class="user-info">
            <i class="fa-solid fa-user">
              <p><strong>User Name</strong>: <%= user.userName %>
              </p>
            </i>
            <i class="fa-solid fa-envelope">
              <p><strong>Email</strong>: <%= user.email %>
              </p>
            </i>
            <!-- Badge Example -->
            <div class="badge">
              <span class="badge-text">Verified</span>
            </div>
            <div class="bottom">
            </div>
          </div>

          <!-- Label to trigger the file input -->
          <label for="profile-image-upload" class="profile-label mt-2"><span>Add Photo</span></label>
        </div>
      </div>

      <div class="row">
        <div class="col">
          <!-- Food Trivia -->
          <div class="fun-facts">
            <h2>Welcome to the Food Trivia Facts</h2>
            <p class="trivia-question">Click the button to get a trivia fact!</p>
            <button id="next-trivia">Next Trivia</button>
          </div>
        </div>
      </div>
    </section>





<!-- Favorite Recipes Section -->
<section id="user-card2">
  <div class="row">
    <div class="col-xl">
      <h2 class="section-title animate__animated animate__fadeInDown">Favorite Recipes</h2>

      <div class="favorite-glide">
        <div class="glide__track" data-glide-el="track">
          <ul class="glide__slides">
            <% if (validFavorites.length > 0) { %>
              <% validFavorites.forEach(fav => { %>
                <li class="glide__slide animate__animated animate__fadeInUp">
                  <div class="favorite-recipe-card">
                    <div class="card-header">
                      <img src="<%= fav.recipe.image %>" alt="<%= fav.recipe.title %>">
                    </div>
                    <div class="card-body">
                      <h4 class="food-title"><%= fav.recipe.title %></h4>
                      <p><i class="fa-solid fa-users"></i> Servings: <%= fav.recipe.servings %></p>
                      <p><i class="fa-regular fa-clock"></i> Ready in: <%= fav.recipe.readyInMinutes %> mins</p>
                      <div class="btn-group">
                        <button class="remove-fav-btn"><i class="fa-solid fa-trash"></i></button>
                        <button class="view-recipe-btn" data-recipe='<%- JSON.stringify(fav.recipe).replace(/'/g, "&#39;") %>'>
                          <i class="fa-solid fa-eye"></i> View
                        </button>
                      </div>
                    </div>
                  </div>
                  
                </li>
              <% }) %>
            <% } else { %>
              <li class="glide__slide">
                <div class="favorite-recipe-card empty">
                  <p>No favorite recipes yet.</p>
                </div>
              </li>
            <% } %>
          </ul>
        </div>
        <div class="glide__arrows" data-glide-el="controls">
          <button class="glide__arrow glide__arrow--left" data-glide-dir="<">
            <i class="fa-solid fa-arrow-left fa-beat"></i>
          </button>
          <button class="glide__arrow glide__arrow--right" data-glide-dir=">">
            <i class="fa-solid fa-arrow-right fa-beat"></i>
          </button>
        </div>
      </div>

    </div>
  </div>
</section>




    <!-- Profile Triva section -->
    <section id="user-card3">
     
    </section>


    <!-- Profile Create Recipe Section -->
    <section id="user-card4">
      <div class="row">
        <div class="col">
          <!-- Create Recipes  -->
          <div class="create-container">
            <div class="create-content">
              <h1>"Create Your Perfect Recipe"..</h1>
              <!-- Cooking animation: Initially hidden -->
              <div id="cookingAnimation">
                <div id="cooking">
                  <div class="bubble"></div>
                  <div class="bubble"></div>
                  <div class="bubble"></div>
                  <div class="bubble"></div>
                  <div class="bubble"></div>
                  <div id="area">
                    <div id="sides">
                      <div id="pan"></div>
                      <div id="handle"></div>
                    </div>
                    <div id="pancake">
                      <div id="pastry"></div>
                    </div>
                  </div>
                </div>
              </div>

              <!-- Recipe Form -->
              <form action="/createRecipe" enctype="multipart/form-data" method="POST" id="recipeForm">
                <div class="mb-3">
                  <label for="name" class="form-label">Recipe Name</label>
                  <input type="text" class="form-control" id="name" name="name" placeholder="e.g., Recipe Name" required>
                </div>
    
                <div class="mb-3">
                  <label for="ingredients" class="form-label">Ingredients</label>
                  <div id="ingredientsList">
                    <input type="text" class="form-control mb-2" name="ingredients[]" placeholder="e.g., Ingredient" required>
                  </div>
                  <button type="button" class="btn btn-secondary" onclick="addIngredient()">Add Ingredient</button>
                </div>
    
                <div class="mb-3">
                  <label for="directions" class="form-label">Directions</label>
                  <textarea class="form-control" id="directions" name="directions" rows="4" required></textarea>
                </div>
    
                <div class="mb-3">
                  <label for="imageUpload" class="form-label">Recipe Image</label>
                  <input type="file" class="form-control" id="imageUpload" name="file" accept="image/*" required>
                </div>
    
                <div class="mb-3">
                  <label for="spoonacularId" class="form-label">Spoonacular ID</label>
                  <input type="text" class="form-control" id="spoonacularId" name="spoonacularId" required>
                </div>
    
                <button type="submit" class="btn btn-success">Submit</button>
              </form>
    
            </div>
          </div>
          <% if (locals.success) { %>
            <script>
              Swal.fire('Success!', '<%= success %>', 'success');
            </script>
          <% } %>
          
          <% if (locals.error) { %>
            <script>
              Swal.fire('Oops!', '<%= error %>', 'error');
            </script>
          <% } %>
          


        </div>
      </div>
    </section>




  </div>
  <!-- Background Wrapper End -->





  <!-- Profile Card  End-->
  <script>
    function addIngredient() {
      const ingredientsList = document.getElementById('ingredientsList');
      const input = document.createElement('input');
      input.type = 'text';
      input.name = 'ingredients[]';
      input.placeholder = 'e.g., Ingredient';
      input.classList.add('form-control', 'mb-2');
      input.required = true;
      ingredientsList.appendChild(input);
    }
  </script>
  

  <!-- Glide.js -->
  <script src="https://cdn.jsdelivr.net/npm/@glidejs/glide/dist/glide.min.js"></script>

  <!-- Include Axios from CDN -->
  <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>

    <!-- sweetalerts -->
   <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>


  <!-- Bootstrap JS -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"
    integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz"
    crossorigin="anonymous"></script>
  <!-- Custom JS -->
  <script type="module" src="js/profile.js"></script>
</body>

</html>